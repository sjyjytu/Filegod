(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{211:function(e,t,n){e.exports=n(360)},360:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(20),o=n.n(r),l=n(24),c=n(25),u=n(28),s=n(26),p=n(29),m=n(363),d=n(362),h=n(18),g=n(15),f=n(19),b=n(134),v=n.n(b),E=n(361),y=n(27),O=n(220),j="http://47.103.0.246:12580",k={upload:function(e,t,n,a){return O.post(j+"/files/upload").attach("file",n).field("title",e).field("author",t).field("description",a).then(function(e){return e.body})},download:function(e){return O.get(j+"/files/download").query({file_id:e})}},w={upload:function(e,t,n,a){return O.post(j+"/links/upload").send({title:e,author:t,link:n,description:a}).then(function(e){return e.body})}},S={show:function(){return O.get(j+"/contents/get").then(function(e){return e.body})}},T=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(u.a)(this,Object(s.a)(t).call(this,e))).handleDownload=n.handleDownload.bind(Object(h.a)(Object(h.a)(n))),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleDownload",value:function(e){window.open("http://47.103.0.246:12580/files/download?file_id=".concat(e),"_blank")}},{key:"componentWillMount",value:function(){this.props.onLoad()}},{key:"render",value:function(){var e=this,t=this.props;t.classes,t.books;return console.log(this.props.contents),i.a.createElement(i.a.Fragment,null,i.a.createElement(E.a,{to:"AddFile"},i.a.createElement(g.a,null,"\u6dfb\u52a0\u6587\u4ef6")),i.a.createElement(E.a,{to:"AddLink"},i.a.createElement(g.a,null,"\u6dfb\u52a0\u94fe\u63a5")),this.props.contents.reverse().map(function(t){return i.a.createElement(g.b,null,i.a.createElement(g.d,{expandIcon:i.a.createElement(v.a,null)},t.title," \xa0",t.author),i.a.createElement(g.c,null,i.a.createElement("div",null,t.description,i.a.createElement("br",null),""!==t.file_id?i.a.createElement(g.a,{onClick:function(){return e.handleDownload(t.file_id)}},"\u4e0b\u8f7d\u6587\u4ef6"):i.a.createElement("a",{href:t.link},t.link))))}))}}]),t}(i.a.Component),C=Object(y.b)(function(e){return{contents:e.contents.contents}},function(e){return{onLoad:function(){e({type:"LOAD_CONTENTS",payload:S.show()})}}})(Object(f.withStyles)(function(e){return{}})(T)),L=n(39),N=n.n(L),x=n(56),D=n(37),R=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(u.a)(this,Object(s.a)(t).call(this,e))).updateState=function(e){return function(t){n.setState(Object(D.a)({},e,t.target.value))}},n.state={title:"",author:"",link:"",description:""},n.updateState=n.updateState.bind(Object(h.a)(Object(h.a)(n))),n.handleSubmit=n.handleSubmit.bind(Object(h.a)(Object(h.a)(n))),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleSubmit",value:function(){var e=Object(x.a)(N.a.mark(function e(t){var n,a,i,r,o;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=this.state,a=n.title,i=n.author,r=n.link,o=n.description,e.next=4,w.upload(a,i,r,o);case 4:this.props.onSave();case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(e){e.redirectTo&&(this.props.history.push(e.redirectTo),this.props.onRedirect())}},{key:"render",value:function(){var e=this.props.classes;return i.a.createElement(i.a.Fragment,null,i.a.createElement(g.f,{className:e.root},i.a.createElement("form",{onSubmit:this.handleSubmit},i.a.createElement("div",{className:e.info},i.a.createElement(g.g,{type:"text",label:"Title",className:e.title,value:this.state.title,onChange:this.updateState("title")}),i.a.createElement("br",null),i.a.createElement(g.g,{type:"text",label:"Author",className:e.title,value:this.state.author,onChange:this.updateState("author")}),i.a.createElement("br",null),i.a.createElement(g.g,{type:"text",label:"Link",className:e.title,value:this.state.link,onChange:this.updateState("link")}),i.a.createElement("br",null),i.a.createElement(g.a,{variant:"contained",className:e.saveClass,type:"submit"},"OK"),i.a.createElement(g.e,{to:"/"},i.a.createElement(g.a,{variant:"contained",className:e.cancel},"Cancel"))),i.a.createElement("div",{className:e.intro},i.a.createElement(g.g,{type:"text",label:"Description",className:e.content,value:this.state.description,onChange:this.updateState("description"),multiline:!0,rows:"18"})),i.a.createElement("br",null))))}}]),t}(i.a.Component),A=Object(y.b)(function(e){return{redirectTo:e.contents.redirectTo}},function(e){return{onSave:function(){return e({type:"OK"})},onRedirect:function(){return e({type:"REDIRECTED"})}}})(Object(f.withStyles)(function(e){return{root:{width:"82%",marginLeft:"9%",marginTop:3*e.spacing.unit},title:{marginTop:e.spacing.unit,marginLeft:"2%"},imageButton:{marginTop:e.spacing.unit,marginLeft:"2%",backgroundColor:e.palette.primary.light},image:{width:30*e.spacing.unit},previewButton:{marginTop:e.spacing.unit,marginLeft:"79%",backgroundColor:e.palette.primary.light},hidden:{display:"none"},content:{width:"96%"},preview:{width:"96%",marginTop:e.spacing.unit,marginLeft:"2%"},saveClass:{marginTop:e.spacing.unit,marginBottom:3*e.spacing.unit,marginLeft:"2%",backgroundColor:e.palette.primary.light},cancel:{marginTop:e.spacing.unit,marginBottom:3*e.spacing.unit,marginLeft:2*e.spacing.unit,backgroundColor:e.palette.primary.light},info:{float:"left",marginLeft:"2%"},intro:{marginLeft:"20%"}}})(R)),B=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(u.a)(this,Object(s.a)(t).call(this,e))).updateState=function(e){return function(t){n.setState(Object(D.a)({},e,t.target.value))}},n.state={title:"",author:"",file:"",description:"",uploading:!1},n.updateState=n.updateState.bind(Object(h.a)(Object(h.a)(n))),n.handleImageChange=n.handleImageChange.bind(Object(h.a)(Object(h.a)(n))),n.handleSubmit=n.handleSubmit.bind(Object(h.a)(Object(h.a)(n))),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleImageChange",value:function(e){this.setState({file:e.target.files[0]})}},{key:"handleSubmit",value:function(){var e=Object(x.a)(N.a.mark(function e(t){var n,a,i,r,o;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=this.state,a=n.title,i=n.author,r=n.file,o=n.description,this.setState({uploading:!0}),e.next=5,k.upload(a,i,r,o);case 5:this.setState({uploading:!1}),this.props.onSave();case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(e){e.redirectTo&&(this.props.history.push(e.redirectTo),this.props.onRedirect())}},{key:"render",value:function(){var e=this,t=this.props.classes;return i.a.createElement(i.a.Fragment,null,i.a.createElement(g.f,{className:t.root},i.a.createElement("form",{onSubmit:this.handleSubmit},i.a.createElement("div",{className:t.info},i.a.createElement(g.g,{type:"text",label:"Title",className:t.title,value:this.state.title,onChange:this.updateState("title")}),i.a.createElement("br",null),i.a.createElement(g.g,{type:"text",label:"Author",className:t.title,value:this.state.author,onChange:this.updateState("author")}),i.a.createElement("br",null),i.a.createElement(g.a,{variant:"contained",className:t.imageButton,onClick:function(){return e.imagePicker.click()}},"\u9009\u62e9\u6587\u4ef6"),i.a.createElement("input",{type:"file",ref:function(t){return e.imagePicker=t},onChange:this.handleImageChange,className:t.hidden}),i.a.createElement("br",null),i.a.createElement(g.a,{variant:"contained",className:t.save,type:"submit",disabled:this.state.uploading},this.state.uploading?"\u4e0a\u4f20\u4e2d...":"\u4e0a\u4f20"),i.a.createElement(E.a,{to:"/"},i.a.createElement(g.a,{variant:"contained",className:t.cancel},"\u53d6\u6d88"))),i.a.createElement("div",{className:t.intro},i.a.createElement(g.g,{type:"text",label:"Description",className:t.content,value:this.state.description,onChange:this.updateState("description"),multiline:!0,rows:"18"})),i.a.createElement("br",null))))}}]),t}(i.a.Component),I=Object(y.b)(function(e){return{redirectTo:e.contents.redirectTo}},function(e){return{onSave:function(){return e({type:"OK"})},onRedirect:function(){return e({type:"REDIRECTED"})}}})(Object(f.withStyles)(function(e){return{root:{width:"82%",marginLeft:"9%",marginTop:3*e.spacing.unit},title:{marginTop:e.spacing.unit,marginLeft:"2%"},imageButton:{marginTop:e.spacing.unit,marginLeft:"2%",backgroundColor:e.palette.primary.light},image:{width:30*e.spacing.unit},previewButton:{marginTop:e.spacing.unit,marginLeft:"79%",backgroundColor:e.palette.primary.light},hidden:{display:"none"},content:{width:"96%"},preview:{width:"96%",marginTop:e.spacing.unit,marginLeft:"2%"},save:{marginTop:e.spacing.unit,marginBottom:3*e.spacing.unit,marginLeft:"2%",backgroundColor:e.palette.primary.light},cancel:{marginTop:e.spacing.unit,marginBottom:3*e.spacing.unit,marginLeft:2*e.spacing.unit,backgroundColor:e.palette.primary.light},info:{float:"left",marginLeft:"2%"},intro:{marginLeft:"20%"}}})(B)),_=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(m.a,null,i.a.createElement("div",{style:{minHeight:445}},i.a.createElement(d.a,{exact:!0,path:"/",component:C}),i.a.createElement(d.a,{exact:!0,path:"/AddFile",component:I}),i.a.createElement(d.a,{exact:!0,path:"/AddLink",component:A}))))}}]),t}(i.a.Component),F=n(38);var P=function(e){return function(t){return function(n){if(console.log("---action.payload---"),console.log(n),(a=n.payload)&&"function"===typeof a.then)return e.dispatch({type:"ASYNC_START"}),console.log("---payload----"),console.log(n.payload),void n.payload.then(function(t){n.payload=t,e.dispatch(n)});var a;t(n)}}},K=n(58),M={contents:[],redirectTo:null},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_CONTENTS":return Object(K.a)({},e,{contents:t.payload.contents});case"OK":return Object(K.a)({},e,{redirectTo:"/"});case"REDIRECTED":return Object(K.a)({},e,{redirectTo:null});default:return e}},J=Object(F.c)({contents:W}),q=Object(F.a)(P),G=Object(F.d)(J,{},q),H=n(22),Y=Object(f.createMuiTheme)({palette:{primary:{light:H.purple[100],main:H.purple[200],dark:H.purple[300]},secondary:{main:H.lime.A400,dark:H.lightGreen.A700},error:{main:H.red[500]}},typography:{fontFamily:"Roboto"}});o.a.render(i.a.createElement(y.a,{store:G},i.a.createElement(f.MuiThemeProvider,{theme:Y},i.a.createElement(_,null))),document.getElementById("root"))}},[[211,1,2]]]);
//# sourceMappingURL=main.4ce4c973.chunk.js.map