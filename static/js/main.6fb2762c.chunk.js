(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{212:function(t,e,n){t.exports=n(361)},361:function(t,e,n){"use strict";n.r(e);var a=n(0),i=n.n(a),r=n(20),o=n.n(r),c=n(25),l=n(26),u=n(29),s=n(27),p=n(30),d=n(363),m=n(365),h=n(364),g=n(18),f=n(22),b=n(15),v=n(19),y=n(135),E=n.n(y),O=n(31),k=n.n(O),j=n(362),w=n(39),S=n(28),T=n(221),C="http://47.103.0.246:12580",L={upload:function(t,e,n,a){return T.post(C+"/files/upload").attach("file",n).field("title",t).field("author",e).field("description",a).then(function(t){return t.body})},download:function(t){return T.get(C+"/files/download").query({file_id:t})}},N={upload:function(t,e,n,a){return T.post(C+"/links/upload").send({title:t,author:e,link:n,description:a}).then(function(t){return t.body})}},x={show:function(){return T.get(C+"/contents/get").then(function(t){return t.body})}},R=function(t){function e(t){var n;return Object(c.a)(this,e),(n=Object(u.a)(this,Object(s.a)(e).call(this,t))).state={keyWord:""},n.handleDownload=n.handleDownload.bind(Object(g.a)(Object(g.a)(n))),n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"handleDownload",value:function(t){window.open("http://47.103.0.246:12580/files/download?file_id=".concat(t),"_blank")}},{key:"componentWillMount",value:function(){this.props.onLoad()}},{key:"contentFilter",value:function(t,e){return-1!==t.author.indexOf(e)||-1!==t.title.indexOf(e)||-1!==t.link.indexOf(e)||-1!==t.description.indexOf(e)}},{key:"render",value:function(){var t=this,e=this.props,n=e.classes;e.books;return console.log(this.props.contents),i.a.createElement(i.a.Fragment,null,i.a.createElement(j.a,{to:"AddFile"},i.a.createElement(b.a,null,"\u6dfb\u52a0\u6587\u4ef6")),i.a.createElement(j.a,{to:"AddLink"},i.a.createElement(b.a,null,"\u6dfb\u52a0\u94fe\u63a5")),i.a.createElement("div",{className:n.search},i.a.createElement(k.a,{placeholder:"\u8f93\u5165\u5173\u952e\u5b57\u67e5\u627e...",classes:{root:n.inputRoot,input:n.inputInput},value:this.state.keyWord,onChange:function(e){return t.setState({keyWord:e.target.value})}})),this.props.contents.reverse().map(function(e){return t.contentFilter(e,t.state.keyWord)?i.a.createElement(b.b,null,i.a.createElement(b.d,{expandIcon:i.a.createElement(E.a,null)},e.title," \xa0",e.author),i.a.createElement(b.c,null,i.a.createElement("div",null,e.description,i.a.createElement("br",null),""!==e.file_id?i.a.createElement(b.a,{onClick:function(){return t.handleDownload(e.file_id)}},"\u4e0b\u8f7d\u6587\u4ef6"):i.a.createElement("a",{href:e.link},e.link)))):null}))}}]),e}(i.a.Component),D=Object(S.b)(function(t){return{contents:t.contents.contents}},function(t){return{onLoad:function(){t({type:"LOAD_CONTENTS",payload:x.show()})}}})(Object(v.withStyles)(function(t){return{inputInput:Object(f.a)({paddingTop:t.spacing.unit,paddingRight:t.spacing.unit,paddingBottom:t.spacing.unit,paddingLeft:10*t.spacing.unit,transition:t.transitions.create("width"),width:"100%"},t.breakpoints.up("md"),{width:200}),inputRoot:{color:"inherit",width:"100%",display:"inline-block"},search:Object(f.a)({position:"relative",borderRadius:t.shape.borderRadius,backgroundColor:Object(w.fade)(t.palette.common.white,.35),"&:hover":{backgroundColor:Object(w.fade)(t.palette.common.white,.55)},marginRight:2*t.spacing.unit,float:"right",width:"400px"},t.breakpoints.down("md"),{width:"auto"})}})(R)),A=n(41),B=n.n(A),I=n(57),F=function(t){function e(t){var n;return Object(c.a)(this,e),(n=Object(u.a)(this,Object(s.a)(e).call(this,t))).updateState=function(t){return function(e){n.setState(Object(f.a)({},t,e.target.value))}},n.state={title:"",author:"",link:"",description:""},n.updateState=n.updateState.bind(Object(g.a)(Object(g.a)(n))),n.handleSubmit=n.handleSubmit.bind(Object(g.a)(Object(g.a)(n))),n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"handleSubmit",value:function(){var t=Object(I.a)(B.a.mark(function t(e){var n,a,i,r,o;return B.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),n=this.state,a=n.title,i=n.author,r=n.link,o=n.description,t.next=4,N.upload(a,i,r,o);case 4:this.props.onSave();case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(t){t.redirectTo&&(this.props.history.push(t.redirectTo),this.props.onRedirect())}},{key:"render",value:function(){var t=this.props.classes;return i.a.createElement(i.a.Fragment,null,i.a.createElement(b.f,{className:t.root},i.a.createElement("form",{onSubmit:this.handleSubmit},i.a.createElement("div",{className:t.info},i.a.createElement(b.g,{type:"text",label:"Title",className:t.title,value:this.state.title,onChange:this.updateState("title")}),i.a.createElement("br",null),i.a.createElement(b.g,{type:"text",label:"Author",className:t.title,value:this.state.author,onChange:this.updateState("author")}),i.a.createElement("br",null),i.a.createElement(b.g,{type:"text",label:"Link",className:t.title,value:this.state.link,onChange:this.updateState("link")}),i.a.createElement("br",null),i.a.createElement(b.a,{variant:"contained",className:t.saveClass,type:"submit"},"OK"),i.a.createElement(b.e,{to:"/"},i.a.createElement(b.a,{variant:"contained",className:t.cancel},"Cancel"))),i.a.createElement("div",{className:t.intro},i.a.createElement(b.g,{type:"text",label:"Description",className:t.content,value:this.state.description,onChange:this.updateState("description"),multiline:!0,rows:"18"})),i.a.createElement("br",null))))}}]),e}(i.a.Component),_=Object(S.b)(function(t){return{redirectTo:t.contents.redirectTo}},function(t){return{onSave:function(){return t({type:"OK"})},onRedirect:function(){return t({type:"REDIRECTED"})}}})(Object(v.withStyles)(function(t){return{root:{width:"82%",marginLeft:"9%",marginTop:3*t.spacing.unit},title:{marginTop:t.spacing.unit,marginLeft:"2%"},imageButton:{marginTop:t.spacing.unit,marginLeft:"2%",backgroundColor:t.palette.primary.light},image:{width:30*t.spacing.unit},previewButton:{marginTop:t.spacing.unit,marginLeft:"79%",backgroundColor:t.palette.primary.light},hidden:{display:"none"},content:{width:"96%"},preview:{width:"96%",marginTop:t.spacing.unit,marginLeft:"2%"},saveClass:{marginTop:t.spacing.unit,marginBottom:3*t.spacing.unit,marginLeft:"2%",backgroundColor:t.palette.primary.light},cancel:{marginTop:t.spacing.unit,marginBottom:3*t.spacing.unit,marginLeft:2*t.spacing.unit,backgroundColor:t.palette.primary.light},info:{float:"left",marginLeft:"2%"},intro:{marginLeft:"20%"}}})(F)),W=function(t){function e(t){var n;return Object(c.a)(this,e),(n=Object(u.a)(this,Object(s.a)(e).call(this,t))).updateState=function(t){return function(e){n.setState(Object(f.a)({},t,e.target.value))}},n.state={title:"",author:"",file:"",description:"",uploading:!1},n.updateState=n.updateState.bind(Object(g.a)(Object(g.a)(n))),n.handleImageChange=n.handleImageChange.bind(Object(g.a)(Object(g.a)(n))),n.handleSubmit=n.handleSubmit.bind(Object(g.a)(Object(g.a)(n))),n}return Object(p.a)(e,t),Object(l.a)(e,[{key:"handleImageChange",value:function(t){this.setState({file:t.target.files[0]})}},{key:"handleSubmit",value:function(){var t=Object(I.a)(B.a.mark(function t(e){var n,a,i,r,o;return B.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),n=this.state,a=n.title,i=n.author,r=n.file,o=n.description,this.setState({uploading:!0}),t.next=5,L.upload(a,i,r,o);case 5:this.setState({uploading:!1}),this.props.onSave();case 7:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(t){t.redirectTo&&(this.props.history.push(t.redirectTo),this.props.onRedirect())}},{key:"render",value:function(){var t=this,e=this.props.classes;return i.a.createElement(i.a.Fragment,null,i.a.createElement(b.f,{className:e.root},i.a.createElement("form",{onSubmit:this.handleSubmit},i.a.createElement("div",{className:e.info},i.a.createElement(b.g,{type:"text",label:"Title",className:e.title,value:this.state.title,onChange:this.updateState("title")}),i.a.createElement("br",null),i.a.createElement(b.g,{type:"text",label:"Author",className:e.title,value:this.state.author,onChange:this.updateState("author")}),i.a.createElement("br",null),i.a.createElement(b.a,{variant:"contained",className:e.imageButton,onClick:function(){return t.imagePicker.click()}},"\u9009\u62e9\u6587\u4ef6"),i.a.createElement("input",{type:"file",ref:function(e){return t.imagePicker=e},onChange:this.handleImageChange,className:e.hidden}),i.a.createElement("br",null),i.a.createElement(b.a,{variant:"contained",className:e.save,type:"submit",disabled:this.state.uploading},this.state.uploading?"\u4e0a\u4f20\u4e2d...":"\u4e0a\u4f20"),i.a.createElement(j.a,{to:"/"},i.a.createElement(b.a,{variant:"contained",className:e.cancel},"\u53d6\u6d88"))),i.a.createElement("div",{className:e.intro},i.a.createElement(b.g,{type:"text",label:"Description",className:e.content,value:this.state.description,onChange:this.updateState("description"),multiline:!0,rows:"18"})),i.a.createElement("br",null))))}}]),e}(i.a.Component),P=Object(S.b)(function(t){return{redirectTo:t.contents.redirectTo}},function(t){return{onSave:function(){return t({type:"OK"})},onRedirect:function(){return t({type:"REDIRECTED"})}}})(Object(v.withStyles)(function(t){return{root:{width:"82%",marginLeft:"9%",marginTop:3*t.spacing.unit},title:{marginTop:t.spacing.unit,marginLeft:"2%"},imageButton:{marginTop:t.spacing.unit,marginLeft:"2%",backgroundColor:t.palette.primary.light},image:{width:30*t.spacing.unit},previewButton:{marginTop:t.spacing.unit,marginLeft:"79%",backgroundColor:t.palette.primary.light},hidden:{display:"none"},content:{width:"96%"},preview:{width:"96%",marginTop:t.spacing.unit,marginLeft:"2%"},save:{marginTop:t.spacing.unit,marginBottom:3*t.spacing.unit,marginLeft:"2%",backgroundColor:t.palette.primary.light},cancel:{marginTop:t.spacing.unit,marginBottom:3*t.spacing.unit,marginLeft:2*t.spacing.unit,backgroundColor:t.palette.primary.light},info:{float:"left",marginLeft:"2%"},intro:{marginLeft:"20%"}}})(W)),K=function(t){function e(){return Object(c.a)(this,e),Object(u.a)(this,Object(s.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return i.a.createElement(d.a,null,i.a.createElement(m.a,null,i.a.createElement(h.a,{exact:!0,path:"/",component:D}),i.a.createElement(h.a,{exact:!0,path:"/AddFile",component:P}),i.a.createElement(h.a,{exact:!0,path:"/AddLink",component:_})))}}]),e}(i.a.Component),M=n(40);var J=function(t){return function(e){return function(n){if(console.log("---action.payload---"),console.log(n),(a=n.payload)&&"function"===typeof a.then)return t.dispatch({type:"ASYNC_START"}),console.log("---payload----"),console.log(n.payload),void n.payload.then(function(e){n.payload=e,t.dispatch(n)});var a;e(n)}}},q=n(60),G={contents:[],redirectTo:null},Y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"LOAD_CONTENTS":return Object(q.a)({},t,{contents:e.payload.contents});case"OK":return Object(q.a)({},t,{redirectTo:"/"});case"REDIRECTED":return Object(q.a)({},t,{redirectTo:null});default:return t}},z=Object(M.c)({contents:Y}),H=Object(M.a)(J),Q=Object(M.d)(z,{},H),U=n(23),V=Object(v.createMuiTheme)({palette:{primary:{light:U.purple[100],main:U.purple[200],dark:U.purple[300]},secondary:{main:U.lime.A400,dark:U.lightGreen.A700},error:{main:U.red[500]}},typography:{fontFamily:"Roboto"}});o.a.render(i.a.createElement(S.a,{store:Q},i.a.createElement(v.MuiThemeProvider,{theme:V},i.a.createElement(K,null))),document.getElementById("root"))}},[[212,1,2]]]);
//# sourceMappingURL=main.6fb2762c.chunk.js.map