(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{211:function(e,t,n){e.exports=n(360)},360:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(20),o=n.n(r),l=n(25),c=n(26),u=n(29),s=n(27),p=n(30),d=n(363),m=n(362),h=n(18),g=n(22),f=n(15),b=n(19),v=n(134),y=n.n(v),E=n(31),O=n.n(E),k=n(361),j=n(39),w=n(28),S=n(220),T="http://47.103.0.246:12580",C={upload:function(e,t,n,a){return S.post(T+"/files/upload").attach("file",n).field("title",e).field("author",t).field("description",a).then(function(e){return e.body})},download:function(e){return S.get(T+"/files/download").query({file_id:e})}},L={upload:function(e,t,n,a){return S.post(T+"/links/upload").send({title:e,author:t,link:n,description:a}).then(function(e){return e.body})}},N={show:function(){return S.get(T+"/contents/get").then(function(e){return e.body})}},x=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(u.a)(this,Object(s.a)(t).call(this,e))).state={keyWord:""},n.handleDownload=n.handleDownload.bind(Object(h.a)(Object(h.a)(n))),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleDownload",value:function(e){window.open("http://47.103.0.246:12580/files/download?file_id=".concat(e),"_blank")}},{key:"componentWillMount",value:function(){this.props.onLoad()}},{key:"contentFilter",value:function(e,t){return-1!==e.author.indexOf(t)||-1!==e.title.indexOf(t)||-1!==e.link.indexOf(t)||-1!==e.description.indexOf(t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes;t.books;return console.log(this.props.contents),i.a.createElement(i.a.Fragment,null,i.a.createElement(k.a,{to:"AddFile"},i.a.createElement(f.a,null,"\u6dfb\u52a0\u6587\u4ef6")),i.a.createElement(k.a,{to:"AddLink"},i.a.createElement(f.a,null,"\u6dfb\u52a0\u94fe\u63a5")),i.a.createElement("div",{className:n.search},i.a.createElement(O.a,{placeholder:"\u8f93\u5165\u5173\u952e\u5b57\u67e5\u627e...",classes:{root:n.inputRoot,input:n.inputInput},value:this.state.keyWord,onChange:function(t){return e.setState({keyWord:t.target.value})}})),this.props.contents.reverse().map(function(t){return e.contentFilter(t,e.state.keyWord)?i.a.createElement(f.b,null,i.a.createElement(f.d,{expandIcon:i.a.createElement(y.a,null)},t.title," \xa0",t.author),i.a.createElement(f.c,null,i.a.createElement("div",null,t.description,i.a.createElement("br",null),""!==t.file_id?i.a.createElement(f.a,{onClick:function(){return e.handleDownload(t.file_id)}},"\u4e0b\u8f7d\u6587\u4ef6"):i.a.createElement("a",{href:t.link},t.link)))):null}))}}]),t}(i.a.Component),R=Object(w.b)(function(e){return{contents:e.contents.contents}},function(e){return{onLoad:function(){e({type:"LOAD_CONTENTS",payload:N.show()})}}})(Object(b.withStyles)(function(e){return{inputInput:Object(g.a)({paddingTop:e.spacing.unit,paddingRight:e.spacing.unit,paddingBottom:e.spacing.unit,paddingLeft:10*e.spacing.unit,transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:200}),inputRoot:{color:"inherit",width:"100%",display:"inline-block"},search:Object(g.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(j.fade)(e.palette.common.white,.35),"&:hover":{backgroundColor:Object(j.fade)(e.palette.common.white,.55)},marginRight:2*e.spacing.unit,float:"right",width:"400px"},e.breakpoints.down("md"),{width:"auto"})}})(x)),D=n(41),A=n.n(D),B=n(57),I=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(u.a)(this,Object(s.a)(t).call(this,e))).updateState=function(e){return function(t){n.setState(Object(g.a)({},e,t.target.value))}},n.state={title:"",author:"",link:"",description:""},n.updateState=n.updateState.bind(Object(h.a)(Object(h.a)(n))),n.handleSubmit=n.handleSubmit.bind(Object(h.a)(Object(h.a)(n))),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleSubmit",value:function(){var e=Object(B.a)(A.a.mark(function e(t){var n,a,i,r,o;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=this.state,a=n.title,i=n.author,r=n.link,o=n.description,e.next=4,L.upload(a,i,r,o);case 4:this.props.onSave();case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(e){e.redirectTo&&(this.props.history.push(e.redirectTo),this.props.onRedirect())}},{key:"render",value:function(){var e=this.props.classes;return i.a.createElement(i.a.Fragment,null,i.a.createElement(f.f,{className:e.root},i.a.createElement("form",{onSubmit:this.handleSubmit},i.a.createElement("div",{className:e.info},i.a.createElement(f.g,{type:"text",label:"Title",className:e.title,value:this.state.title,onChange:this.updateState("title")}),i.a.createElement("br",null),i.a.createElement(f.g,{type:"text",label:"Author",className:e.title,value:this.state.author,onChange:this.updateState("author")}),i.a.createElement("br",null),i.a.createElement(f.g,{type:"text",label:"Link",className:e.title,value:this.state.link,onChange:this.updateState("link")}),i.a.createElement("br",null),i.a.createElement(f.a,{variant:"contained",className:e.saveClass,type:"submit"},"OK"),i.a.createElement(f.e,{to:"/"},i.a.createElement(f.a,{variant:"contained",className:e.cancel},"Cancel"))),i.a.createElement("div",{className:e.intro},i.a.createElement(f.g,{type:"text",label:"Description",className:e.content,value:this.state.description,onChange:this.updateState("description"),multiline:!0,rows:"18"})),i.a.createElement("br",null))))}}]),t}(i.a.Component),F=Object(w.b)(function(e){return{redirectTo:e.contents.redirectTo}},function(e){return{onSave:function(){return e({type:"OK"})},onRedirect:function(){return e({type:"REDIRECTED"})}}})(Object(b.withStyles)(function(e){return{root:{width:"82%",marginLeft:"9%",marginTop:3*e.spacing.unit},title:{marginTop:e.spacing.unit,marginLeft:"2%"},imageButton:{marginTop:e.spacing.unit,marginLeft:"2%",backgroundColor:e.palette.primary.light},image:{width:30*e.spacing.unit},previewButton:{marginTop:e.spacing.unit,marginLeft:"79%",backgroundColor:e.palette.primary.light},hidden:{display:"none"},content:{width:"96%"},preview:{width:"96%",marginTop:e.spacing.unit,marginLeft:"2%"},saveClass:{marginTop:e.spacing.unit,marginBottom:3*e.spacing.unit,marginLeft:"2%",backgroundColor:e.palette.primary.light},cancel:{marginTop:e.spacing.unit,marginBottom:3*e.spacing.unit,marginLeft:2*e.spacing.unit,backgroundColor:e.palette.primary.light},info:{float:"left",marginLeft:"2%"},intro:{marginLeft:"20%"}}})(I)),_=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(u.a)(this,Object(s.a)(t).call(this,e))).updateState=function(e){return function(t){n.setState(Object(g.a)({},e,t.target.value))}},n.state={title:"",author:"",file:"",description:"",uploading:!1},n.updateState=n.updateState.bind(Object(h.a)(Object(h.a)(n))),n.handleImageChange=n.handleImageChange.bind(Object(h.a)(Object(h.a)(n))),n.handleSubmit=n.handleSubmit.bind(Object(h.a)(Object(h.a)(n))),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleImageChange",value:function(e){this.setState({file:e.target.files[0]})}},{key:"handleSubmit",value:function(){var e=Object(B.a)(A.a.mark(function e(t){var n,a,i,r,o;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=this.state,a=n.title,i=n.author,r=n.file,o=n.description,this.setState({uploading:!0}),e.next=5,C.upload(a,i,r,o);case 5:this.setState({uploading:!1}),this.props.onSave();case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(e){e.redirectTo&&(this.props.history.push(e.redirectTo),this.props.onRedirect())}},{key:"render",value:function(){var e=this,t=this.props.classes;return i.a.createElement(i.a.Fragment,null,i.a.createElement(f.f,{className:t.root},i.a.createElement("form",{onSubmit:this.handleSubmit},i.a.createElement("div",{className:t.info},i.a.createElement(f.g,{type:"text",label:"Title",className:t.title,value:this.state.title,onChange:this.updateState("title")}),i.a.createElement("br",null),i.a.createElement(f.g,{type:"text",label:"Author",className:t.title,value:this.state.author,onChange:this.updateState("author")}),i.a.createElement("br",null),i.a.createElement(f.a,{variant:"contained",className:t.imageButton,onClick:function(){return e.imagePicker.click()}},"\u9009\u62e9\u6587\u4ef6"),i.a.createElement("input",{type:"file",ref:function(t){return e.imagePicker=t},onChange:this.handleImageChange,className:t.hidden}),i.a.createElement("br",null),i.a.createElement(f.a,{variant:"contained",className:t.save,type:"submit",disabled:this.state.uploading},this.state.uploading?"\u4e0a\u4f20\u4e2d...":"\u4e0a\u4f20"),i.a.createElement(k.a,{to:"/"},i.a.createElement(f.a,{variant:"contained",className:t.cancel},"\u53d6\u6d88"))),i.a.createElement("div",{className:t.intro},i.a.createElement(f.g,{type:"text",label:"Description",className:t.content,value:this.state.description,onChange:this.updateState("description"),multiline:!0,rows:"18"})),i.a.createElement("br",null))))}}]),t}(i.a.Component),W=Object(w.b)(function(e){return{redirectTo:e.contents.redirectTo}},function(e){return{onSave:function(){return e({type:"OK"})},onRedirect:function(){return e({type:"REDIRECTED"})}}})(Object(b.withStyles)(function(e){return{root:{width:"82%",marginLeft:"9%",marginTop:3*e.spacing.unit},title:{marginTop:e.spacing.unit,marginLeft:"2%"},imageButton:{marginTop:e.spacing.unit,marginLeft:"2%",backgroundColor:e.palette.primary.light},image:{width:30*e.spacing.unit},previewButton:{marginTop:e.spacing.unit,marginLeft:"79%",backgroundColor:e.palette.primary.light},hidden:{display:"none"},content:{width:"96%"},preview:{width:"96%",marginTop:e.spacing.unit,marginLeft:"2%"},save:{marginTop:e.spacing.unit,marginBottom:3*e.spacing.unit,marginLeft:"2%",backgroundColor:e.palette.primary.light},cancel:{marginTop:e.spacing.unit,marginBottom:3*e.spacing.unit,marginLeft:2*e.spacing.unit,backgroundColor:e.palette.primary.light},info:{float:"left",marginLeft:"2%"},intro:{marginLeft:"20%"}}})(_)),P=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.a,null,i.a.createElement("div",{style:{minHeight:445}},i.a.createElement(m.a,{exact:!0,path:"/",component:R}),i.a.createElement(m.a,{exact:!0,path:"/AddFile",component:W}),i.a.createElement(m.a,{exact:!0,path:"/AddLink",component:F}))))}}]),t}(i.a.Component),K=n(40);var M=function(e){return function(t){return function(n){if(console.log("---action.payload---"),console.log(n),(a=n.payload)&&"function"===typeof a.then)return e.dispatch({type:"ASYNC_START"}),console.log("---payload----"),console.log(n.payload),void n.payload.then(function(t){n.payload=t,e.dispatch(n)});var a;t(n)}}},J=n(59),q={contents:[],redirectTo:null},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_CONTENTS":return Object(J.a)({},e,{contents:t.payload.contents});case"OK":return Object(J.a)({},e,{redirectTo:"/"});case"REDIRECTED":return Object(J.a)({},e,{redirectTo:null});default:return e}},H=Object(K.c)({contents:G}),Y=Object(K.a)(M),z=Object(K.d)(H,{},Y),Q=n(23),U=Object(b.createMuiTheme)({palette:{primary:{light:Q.purple[100],main:Q.purple[200],dark:Q.purple[300]},secondary:{main:Q.lime.A400,dark:Q.lightGreen.A700},error:{main:Q.red[500]}},typography:{fontFamily:"Roboto"}});o.a.render(i.a.createElement(w.a,{store:z},i.a.createElement(b.MuiThemeProvider,{theme:U},i.a.createElement(P,null))),document.getElementById("root"))}},[[211,1,2]]]);
//# sourceMappingURL=main.3cd1be4d.chunk.js.map